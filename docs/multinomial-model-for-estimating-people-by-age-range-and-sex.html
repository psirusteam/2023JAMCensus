<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Multinomial model for estimating people by age range and sex | Area-Model-Methodologies-for-Census-Person-Count-Imputation</title>
  <meta name="description" content="Workshop on Capacity Building Installation" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Multinomial model for estimating people by age range and sex | Area-Model-Methodologies-for-Census-Person-Count-Imputation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Workshop on Capacity Building Installation" />
  <meta name="github-repo" content="psirusteam/HHS-Handbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Multinomial model for estimating people by age range and sex | Area-Model-Methodologies-for-Census-Person-Count-Imputation" />
  
  <meta name="twitter:description" content="Workshop on Capacity Building Installation" />
  



<meta name="date" content="2023-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="consolidating-the-number-of-people-per-household.html"/>
<link rel="next" href="creating-the-census-base-with-predictions-from-the-multinomial-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Workshop on Capacity Building Installation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Workshop Materials</a></li>
<li class="chapter" data-level="1" data-path="installation-of-libraries-and-required-software-for-bayesian-area-models..html"><a href="installation-of-libraries-and-required-software-for-bayesian-area-models..html"><i class="fa fa-check"></i><b>1</b> Installation of Libraries and Required Software for Bayesian Area Models.</a>
<ul>
<li class="chapter" data-level="1.1" data-path="step-1-installing-software.html"><a href="step-1-installing-software.html"><i class="fa fa-check"></i><b>1.1</b> Step 1: Installing Software</a></li>
<li class="chapter" data-level="1.2" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html"><i class="fa fa-check"></i><b>1.2</b> Step 2: Installing the following libraries in <em>R.</em></a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#data-visualization-and-manipulation"><i class="fa fa-check"></i><b>1.2.1</b> Data Visualization and Manipulation:</a></li>
<li class="chapter" data-level="1.2.2" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#statistical-modeling"><i class="fa fa-check"></i><b>1.2.2</b> Statistical Modeling:</a></li>
<li class="chapter" data-level="1.2.3" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#survey-analysis"><i class="fa fa-check"></i><b>1.2.3</b> Survey Analysis:</a></li>
<li class="chapter" data-level="1.2.4" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#data-manipulation-and-transformation"><i class="fa fa-check"></i><b>1.2.4</b> Data Manipulation and Transformation:</a></li>
<li class="chapter" data-level="1.2.5" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#bayesian-analysis"><i class="fa fa-check"></i><b>1.2.5</b> Bayesian Analysis:</a></li>
<li class="chapter" data-level="1.2.6" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#geospatial-analysis"><i class="fa fa-check"></i><b>1.2.6</b> Geospatial Analysis:</a></li>
<li class="chapter" data-level="1.2.7" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#miscellaneous"><i class="fa fa-check"></i><b>1.2.7</b> Miscellaneous:</a></li>
<li class="chapter" data-level="1.2.8" data-path="step-2-installing-the-following-libraries-in-r..html"><a href="step-2-installing-the-following-libraries-in-r..html#step-by-step-guide-to-install-rstan"><i class="fa fa-check"></i><b>1.2.8</b> Step-by-Step Guide to Install rstan</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="step-3-validation-of-installation---ensuring-proper-rstan-installation.html"><a href="step-3-validation-of-installation---ensuring-proper-rstan-installation.html"><i class="fa fa-check"></i><b>1.3</b> Step 3: Validation of Installation - Ensuring Proper <code>rstan</code> Installation</a></li>
<li class="chapter" data-level="1.4" data-path="step-4-creating-a-google-earth-engine-account.html"><a href="step-4-creating-a-google-earth-engine-account.html"><i class="fa fa-check"></i><b>1.4</b> Step 4: Creating a Google Earth Engine Account:</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="standardization-and-validation-of-available-census-data-variables.html"><a href="standardization-and-validation-of-available-census-data-variables.html"><i class="fa fa-check"></i><b>2</b> Standardization and Validation of Available Census Data Variables</a>
<ul>
<li class="chapter" data-level="2.1" data-path="assigning-missing-values-to-the-h01a_total_personas-variable.html"><a href="assigning-missing-values-to-the-h01a_total_personas-variable.html"><i class="fa fa-check"></i><b>2.1</b> Assigning Missing Values to the ‘H01A_TOTAL_PERSONAS’ Variable</a></li>
<li class="chapter" data-level="2.2" data-path="descriptive-values-of-the-census-data.html"><a href="descriptive-values-of-the-census-data.html"><i class="fa fa-check"></i><b>2.2</b> Descriptive Values of the Census Data</a>
<ul>
<li class="chapter" data-level="" data-path="descriptive-values-of-the-census-data.html"><a href="descriptive-values-of-the-census-data.html#numeric-variables"><i class="fa fa-check"></i>Numeric Variables</a></li>
<li class="chapter" data-level="" data-path="descriptive-values-of-the-census-data.html"><a href="descriptive-values-of-the-census-data.html#character-variables"><i class="fa fa-check"></i>Character Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="organizing-results-in-a-database.html"><a href="organizing-results-in-a-database.html"><i class="fa fa-check"></i><b>2.3</b> Organizing Results in a Database</a></li>
<li class="chapter" data-level="2.4" data-path="updating-the-dataset-based-on-report-results.html"><a href="updating-the-dataset-based-on-report-results.html"><i class="fa fa-check"></i><b>2.4</b> Updating the Dataset Based on Report Results</a></li>
<li class="chapter" data-level="2.5" data-path="dataset-refinement-and-analysis.html"><a href="dataset-refinement-and-analysis.html"><i class="fa fa-check"></i><b>2.5</b> Dataset Refinement and Analysis</a></li>
<li class="chapter" data-level="2.6" data-path="summary-and-analysis-of-data.html"><a href="summary-and-analysis-of-data.html"><i class="fa fa-check"></i><b>2.6</b> Summary and Analysis of Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="filtering-and-refining-census-data.html"><a href="filtering-and-refining-census-data.html"><i class="fa fa-check"></i><b>3</b> Filtering and Refining Census Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html"><i class="fa fa-check"></i><b>3.1</b> Reading Libraries, Databases, and Other Inputs</a>
<ul>
<li class="chapter" data-level="" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html#reading-housing-data-without-coordinates."><i class="fa fa-check"></i>Reading Housing Data without Coordinates.</a></li>
<li class="chapter" data-level="" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html#changing-ugm-codes-in-the-housing-data."><i class="fa fa-check"></i>Changing UGM Codes in the Housing Data.</a></li>
<li class="chapter" data-level="" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html#read-the-standardized-census-data."><i class="fa fa-check"></i>Read the Standardized Census Data.</a></li>
<li class="chapter" data-level="" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html#adding-the-age-sex-base."><i class="fa fa-check"></i>Adding the Age-Sex Base.</a></li>
<li class="chapter" data-level="3.1.1" data-path="reading-libraries-databases-and-other-inputs.html"><a href="reading-libraries-databases-and-other-inputs.html#inner-join-to-add-the-age-sex-base"><i class="fa fa-check"></i><b>3.1.1</b> Inner Join to Add the Age-Sex Base</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html"><i class="fa fa-check"></i><b>3.2</b> Applying filters and analyzing the data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#applying-the-first-filter-categorizing-households-with-residents-and-determining-greenpoint-status"><i class="fa fa-check"></i><b>3.2.1</b> Applying the first filter: categorizing households with residents and determining greenpoint status</a></li>
<li class="chapter" data-level="3.2.2" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#applying-the-second-filter-worldpop-criterion"><i class="fa fa-check"></i><b>3.2.2</b> Applying the second filter: WorldPop criterion</a></li>
<li class="chapter" data-level="3.2.3" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#summary-of-statistics-based-on-greenpoint2"><i class="fa fa-check"></i><b>3.2.3</b> Summary of Statistics Based on ‘greenpoint2’</a></li>
<li class="chapter" data-level="3.2.4" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#defining-the-third-filter"><i class="fa fa-check"></i><b>3.2.4</b> Defining the Third Filter</a></li>
<li class="chapter" data-level="3.2.5" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#combining-non-coordinated-houses"><i class="fa fa-check"></i><b>3.2.5</b> Combining non-coordinated houses</a></li>
<li class="chapter" data-level="3.2.6" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#aggregating-statistics-and-summaries"><i class="fa fa-check"></i><b>3.2.6</b> Aggregating statistics and summaries</a></li>
<li class="chapter" data-level="3.2.7" data-path="applying-filters-and-analyzing-the-data.html"><a href="applying-filters-and-analyzing-the-data.html#extracting-and-saving-subset"><i class="fa fa-check"></i><b>3.2.7</b> Extracting and Saving Subset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="standardization-and-validation-of-covariates.html"><a href="standardization-and-validation-of-covariates.html"><i class="fa fa-check"></i><b>4</b> Standardization and validation of covariates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="environment-preparation-and-library-loading.html"><a href="environment-preparation-and-library-loading.html"><i class="fa fa-check"></i><b>4.1</b> Environment Preparation and Library Loading</a></li>
<li class="chapter" data-level="4.2" data-path="descriptive-values-of-the-ugms-base.html"><a href="descriptive-values-of-the-ugms-base.html"><i class="fa fa-check"></i><b>4.2</b> Descriptive values of the UGMS base</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="descriptive-values-of-the-ugms-base.html"><a href="descriptive-values-of-the-ugms-base.html#standardizing-variables-and-joining-datasets"><i class="fa fa-check"></i><b>4.2.1</b> Standardizing Variables and Joining Datasets</a></li>
<li class="chapter" data-level="4.2.2" data-path="descriptive-values-of-the-ugms-base.html"><a href="descriptive-values-of-the-ugms-base.html#standardize-numeric-variables-using-z-score-scaling"><i class="fa fa-check"></i><b>4.2.2</b> Standardize numeric variables using z-score scaling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="binomial-unit-model-for-occupied-dwellings.html"><a href="binomial-unit-model-for-occupied-dwellings.html"><i class="fa fa-check"></i><b>5</b> Binomial unit model for occupied dwellings</a>
<ul>
<li class="chapter" data-level="5.1" data-path="preparing-the-environment-and-data.html"><a href="preparing-the-environment-and-data.html"><i class="fa fa-check"></i><b>5.1</b> Preparing the Environment and Data</a></li>
<li class="chapter" data-level="5.2" data-path="defining-desocupada-column-classifying-occupancy-status.html"><a href="defining-desocupada-column-classifying-occupancy-status.html"><i class="fa fa-check"></i><b>5.2</b> Defining ‘Desocupada’ Column: Classifying Occupancy Status</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="defining-desocupada-column-classifying-occupancy-status.html"><a href="defining-desocupada-column-classifying-occupancy-status.html#counting-combinations-of-occupancy-status-and-greenpoint-values"><i class="fa fa-check"></i><b>5.2.1</b> Counting Combinations of Occupancy Status and Greenpoint Values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="consolidation-of-census-housing-databases.html"><a href="consolidation-of-census-housing-databases.html"><i class="fa fa-check"></i><b>6</b> Consolidation of CENSUS housing databases</a>
<ul>
<li class="chapter" data-level="6.1" data-path="defining-occupied-and-unoccupied-houses..html"><a href="defining-occupied-and-unoccupied-houses..html"><i class="fa fa-check"></i><b>6.1</b> Defining occupied and unoccupied houses.</a></li>
<li class="chapter" data-level="6.2" data-path="summary-measures-and-results-validation.html"><a href="summary-measures-and-results-validation.html"><i class="fa fa-check"></i><b>6.2</b> Summary Measures and Results Validation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-of-the-number-of-people-per-household.html"><a href="estimation-of-the-number-of-people-per-household.html"><i class="fa fa-check"></i><b>7</b> Estimation of the number of people per household</a>
<ul>
<li class="chapter" data-level="7.1" data-path="reading-the-census-data..html"><a href="reading-the-census-data..html"><i class="fa fa-check"></i><b>7.1</b> Reading the census data.</a></li>
<li class="chapter" data-level="7.2" data-path="preparing-data-for-model-1.html"><a href="preparing-data-for-model-1.html"><i class="fa fa-check"></i><b>7.2</b> Preparing data for Model 1</a></li>
<li class="chapter" data-level="7.3" data-path="preparing-data-for-model-2.html"><a href="preparing-data-for-model-2.html"><i class="fa fa-check"></i><b>7.3</b> Preparing data for Model 2</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="consolidating-the-number-of-people-per-household.html"><a href="consolidating-the-number-of-people-per-household.html"><i class="fa fa-check"></i><b>8</b> consolidating the number of people per household</a></li>
<li class="chapter" data-level="9" data-path="multinomial-model-for-estimating-people-by-age-range-and-sex.html"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html"><i class="fa fa-check"></i><b>9</b> Multinomial model for estimating people by age range and sex</a></li>
<li class="chapter" data-level="10" data-path="creating-the-census-base-with-predictions-from-the-multinomial-model.html"><a href="creating-the-census-base-with-predictions-from-the-multinomial-model.html"><i class="fa fa-check"></i><b>10</b> Creating the census base with predictions from the multinomial model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="results-by-provinces.html"><a href="results-by-provinces.html"><i class="fa fa-check"></i><b>10.1</b> Results by Provinces</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="aggregated-estimations.html"><a href="aggregated-estimations.html"><i class="fa fa-check"></i><b>11</b> Aggregated Estimations</a>
<ul>
<li class="chapter" data-level="" data-path="aggregated-estimations.html"><a href="aggregated-estimations.html#reading-the-census-data.-1"><i class="fa fa-check"></i>Reading the census data.</a></li>
<li class="chapter" data-level="11.1" data-path="prediction-of-the-unoccupied-household-rate.html"><a href="prediction-of-the-unoccupied-household-rate.html"><i class="fa fa-check"></i><b>11.1</b> Prediction of the unoccupied household rate</a></li>
<li class="chapter" data-level="11.2" data-path="total-population-prediction.html"><a href="total-population-prediction.html"><i class="fa fa-check"></i><b>11.2</b> Total Population Prediction</a></li>
<li class="chapter" data-level="11.3" data-path="prediction-of-total-population-by-age-and-gender.html"><a href="prediction-of-total-population-by-age-and-gender.html"><i class="fa fa-check"></i><b>11.3</b> Prediction of Total Population by Age and Gender</a></li>
</ul></li>
<li class="divider"></li>
<li><a Workshop on Capacity Building Installation </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multinomial-model-for-estimating-people-by-age-range-and-sex" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Multinomial model for estimating people by age range and sex<a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#multinomial-model-for-estimating-people-by-age-range-and-sex" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the final step, we model the demographic structure of Small Geographic Units (UGMs) at the province level. This structure consists of 40 subgroups based on the combination of gender and age groups. To estimate the demographics of unobserved households, we make use of conditional prediction based on the outcomes from the previous step.</p>
<p>Given the nature of the phenomenon under study, a multinomial distribution is considered suitable for the count of individuals across the 40 groups. Here’s an explanation of the model:</p>
<ul>
<li><span class="math inline">\(G_i\)</span> follows a Multinomial distribution <span class="math inline">\(Multinomial(p_{G_i})\)</span>.</li>
<li>The log-odds of <span class="math inline">\(p_{G_i}\)</span> are modeled by <span class="math inline">\(x_i^&#39; \beta\)</span>.</li>
</ul>
<p>In this context, <span class="math inline">\(G_i\)</span> represents the count for each of the forty demographic groups. <span class="math inline">\(p_{G_i}\)</span> is a vector of size 40 containing the probabilities that a person classified in each group resides in a household.</p>
<ul>
<li>Cleaning R environment
The code removes all objects from the current R environment, ensuring a clean slate for the subsequent operations.</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-1" tabindex="-1"></a><span class="co"># Clearing the R environment by removing all variables from memory.</span></span>
<span id="cb104-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb104-3"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-3" tabindex="-1"></a><span class="co"># Loading necessary libraries for data analysis.</span></span>
<span id="cb104-4"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)   <span class="co"># Data manipulation and visualization</span></span>
<span id="cb104-5"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-5" tabindex="-1"></a><span class="fu">library</span>(data.table)  <span class="co"># Fast data manipulation</span></span>
<span id="cb104-6"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-6" tabindex="-1"></a><span class="fu">library</span>(openxlsx)    <span class="co"># Reading Excel files</span></span>
<span id="cb104-7"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-7" tabindex="-1"></a><span class="fu">library</span>(magrittr)    <span class="co"># Pipe operator</span></span>
<span id="cb104-8"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-8" tabindex="-1"></a><span class="fu">library</span>(lme4)        <span class="co"># For fitting linear mixed-effects models</span></span>
<span id="cb104-9"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-9" tabindex="-1"></a><span class="fu">library</span>(nnet)        <span class="co"># For fitting neural networks</span></span>
<span id="cb104-10"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb104-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\f</span><span class="st">&quot;</span>)  <span class="co"># Clears console output</span></span></code></pre></div>
<div style="page-break-after: always;"></div>
<ul>
<li>Data Reading</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-1" tabindex="-1"></a><span class="co"># Reading the preprocessed census data file containing information about households.</span></span>
<span id="cb105-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-2" tabindex="-1"></a>censo_vivienda <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;Recursos/06_Model_Multinomial/Data/02_censo_vivienda_personas.rds&quot;</span>) </span>
<span id="cb105-3"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-3" tabindex="-1"></a></span>
<span id="cb105-4"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-4" tabindex="-1"></a><span class="co"># Filtering the census data to retain relevant columns for age and gender analysis.</span></span>
<span id="cb105-5"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-5" tabindex="-1"></a>censo_vivienda_age_gender <span class="ot">&lt;-</span> censo_vivienda <span class="sc">%&gt;%</span> </span>
<span id="cb105-6"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-6" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="sc">!</span>greenpoint2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sin informacion pero  n&gt;0&quot;</span>, </span>
<span id="cb105-7"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-7" tabindex="-1"></a>                              <span class="st">&quot;Sin informacion pero n&gt;=0&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-8"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb105-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(PROV_ID, HOMBRES_GRUPO1_sum<span class="sc">:</span>MUJERES_GRUPO20_sum)</span></code></pre></div>
<ul>
<li><p>Data Preparation:</p>
<p>The code creates a new dataset censo_vivienda_edad_sexo by filtering out specific entries from censo_vivienda. It selects columns related to age and gender groups and provinces. This filtered dataset is then aggregated at the PROV_ID level using the summarise_if function.</p></li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb106-1" tabindex="-1"></a><span class="co"># Summarizing the age and gender data by grouping it based on province (PROV_ID).</span></span>
<span id="cb106-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb106-2" tabindex="-1"></a>censo_personas <span class="ot">&lt;-</span> censo_vivienda_age_gender <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb106-3" tabindex="-1"></a>  <span class="fu">group_by</span>(PROV_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb106-4"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb106-4" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.numeric, sum)</span></code></pre></div>
<ul>
<li><p>Multinomial Model:</p>
<p>A multinomial model is created using the <code>multinom</code> function. It predicts the distribution of age and gender groups within households based on the province (<code>PROV_ID</code>). The model is stored in the variable <code>model</code>.</p></li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb107-1" tabindex="-1"></a><span class="co"># Fitting a multinomial model to estimate the distribution of age and gender within households,</span></span>
<span id="cb107-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb107-2" tabindex="-1"></a><span class="co"># using province as the predictor.</span></span>
<span id="cb107-3"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb107-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">multinom</span>( censo_personas[,<span class="sc">-</span><span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">~</span> censo_personas<span class="sc">$</span>PROV_ID)</span></code></pre></div>
<pre><code>## # weights:  320 (273 variable)
## initial  value 9098525.262706 
## iter  10 value 8725423.620363
## iter  20 value 8724936.747528
## iter  30 value 8724362.718376
## iter  40 value 8723575.429512
## iter  50 value 8719973.199033
## iter  60 value 8714415.379026
## iter  70 value 8692534.417677
## iter  80 value 8664249.357504
## iter  90 value 8663007.095699
## iter 100 value 8662293.319310
## final  value 8662293.319310 
## stopped after 100 iterations</code></pre>
<ul>
<li><p>Model Prediction</p>
<p>The <code>predict</code> function is used to predict the distribution probabilities for the multinomial model. The prediction results are not displayed here but can be obtained using the <code>predict</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb109-1" tabindex="-1"></a><span class="co"># Predicting the distribution probabilities using the fitted model.</span></span>
<span id="cb109-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb109-2" tabindex="-1"></a><span class="fu">predict</span>(model,<span class="at">type =</span> <span class="st">&quot;probs&quot;</span>)</span></code></pre></div>
<ul>
<li><p>Saving Model</p>
<p>The trained multinomial model is saved as an RDS file (“Recursos/06_Model_Multinomial/Data/Modelo_multinomial.rds”) using the <code>saveRDS</code> function.</p></li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb110-1" tabindex="-1"></a><span class="co"># Saving the fitted multinomial model to a file.</span></span>
<span id="cb110-2"><a href="multinomial-model-for-estimating-people-by-age-range-and-sex.html#cb110-2" tabindex="-1"></a><span class="fu">saveRDS</span>(model, <span class="st">&quot;Recursos/06_Model_Multinomial/Data/Multinomial_model.rds&quot;</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="consolidating-the-number-of-people-per-household.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="creating-the-census-base-with-predictions-from-the-multinomial-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/2021ASDA/08_Modelo_multinomial.qmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Area Model Methodologies for Census Person Count Imputation.pdf", "Area Model Methodologies for Census Person Count Imputation.epub", "Area Model Methodologies for Census Person Count Imputation.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
